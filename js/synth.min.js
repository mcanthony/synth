/*synth v175*/function checkLoad() {
    if (videoInput.readyState === 4) {
        init();
        animate();
    } else setTimeout(checkLoad, 100);
}

function playAudio(playlistId) {
    audioisplaying = !1;
    audioplayer.pause();
    audioplayer.remove();
    audioplayer = container.appendChild(document.createElement("audio"));
    $("#close_drop").is(".active") ? $("audio").hide() : $("audio").show();
    audioplayer.id = "audio";
    audioplayer.controls = !0;
    audioplayer.src = audio.playlist[playlistId];
    dancer.after(0, function() {
        ruttEtraParams.bass = this.getFrequency(140) * 100;
        ruttEtraParams.mid = this.getFrequency(210) * 100;
        ruttEtraParams.treble = this.getFrequency(460) * 100;
    }).load(audioplayer);
    audioplayer.play();
    dancer.play();
    audioisplaying = !0;
    $("#playlist").children("li").css("background-color", "#010101");
    $("#playlist").children("li").eq(playlistId).css("background-color", "#232323");
}

function continueAudioPlay() {
    audio.current++;
    var playlist = audio.playlist, length = playlist.length;
    if (audio.current == length) {
        audio.current = 0;
        playAudio(audio.current);
    } else playAudio(audio.current);
}

function continueVideoPlay() {
    videoInput.current++;
    var playlist = video.playlist, length = playlist.length;
    if (videoInput.current == length) {
        videoInput.current = 0;
        playVideo(videoInput.current);
    } else playVideo(videoInput.current);
}

function playVideo(playlistId) {
    videoInput.pause();
    videoisplaying = !1;
    videoInput.src = video.playlist[playlistId];
    videoInput.loop = !1;
    videoInput.muted = !0;
    videoInput.play();
    videoisplaying = !0;
    $("#videoplaylist").children("li").css("background-color", "#010101");
    $("#videoplaylist").children("li").eq(playlistId).css("background-color", "#232323");
}

function toArray(list) {
    return Array.prototype.slice.call(list || [], 0);
}

function errorHandler(err) {
    var msg = "An error occured: ";
    switch (err.code) {
      case FileError.NOT_FOUND_ERR:
        msg += "File or directory not found";
        break;
      case FileError.NOT_READABLE_ERR:
        msg += "File or directory not readable";
        break;
      case FileError.PATH_EXISTS_ERR:
        msg += "File or directory already exists";
        break;
      case FileError.TYPE_MISMATCH_ERR:
        msg += "Invalid filetype";
        break;
      default:
        msg += "Unknown Error";
    }
    console.log(msg);
}

function listAudioResults(entries) {
    var fragment = document.createDocumentFragment();
    entries.forEach(function(entry, i) {
        audio.playlist.push(entry.toURL());
        var li = document.createElement("li"), name = unescape(entry.name), correctName = unescape(entry.name);
        correctName.length > 30 && (correctName = correctName.substring(0, 30));
        li.innerHTML = [ '<a class="track" href="#" data-href="', entry.toURL(), '" data-title="', correctName, '">', correctName, "</a>" ].join("");
        document.getElementById("playlist").insertBefore(li, null);
        var nodeList = Array.prototype.slice.call(document.getElementById("playlist").children), index = nodeList.indexOf(li);
        li.onclick = function() {
            playAudio(index);
            audio.current = index;
            audioplayer.addEventListener("ended", continueAudioPlay, !1);
            $("#close_drop").trigger("click");
        };
    });
    document.querySelector("#playlist").appendChild(fragment);
    $("#read_files").fadeOut(1e3);
}

function listVideoResults(entries) {
    var fragment = document.createDocumentFragment();
    entries.forEach(function(entry, i) {
        video.playlist.push(entry.toURL());
        var li = document.createElement("li"), name = unescape(entry.name), correctName = unescape(entry.name);
        correctName.length > 30 && (correctName = correctName.substring(0, 30));
        li.innerHTML = [ '<a class="track" href="#" data-href="', entry.toURL(), '" data-title="', correctName, '">', correctName, "</a>" ].join("");
        document.getElementById("videoplaylist").insertBefore(li, null);
        var nodeList = Array.prototype.slice.call(document.getElementById("videoplaylist").children), index = nodeList.indexOf(li);
        li.onclick = function() {
            playVideo(index);
            videoInput.current = index;
            videoInput.addEventListener("ended", continueVideoPlay, !1);
            $("#close_drop").trigger("click");
        };
    });
    document.querySelector("#playlist").appendChild(fragment);
    $("#read_video").fadeOut(1e3);
}

function readAudioFileSelect(evt) {
    evt.stopPropagation();
    evt.preventDefault();
    window.requestFileSystem(window.TEMPORARY, 838860800, function(fs) {
        fs.root.getDirectory("audio", {}, function(dirEntry) {
            var dirReader = dirEntry.createReader(), entries = [], readEntries = function() {
                dirReader.readEntries(function(results) {
                    if (!results.length) listAudioResults(entries.sort()); else {
                        entries = entries.concat(toArray(results));
                        readEntries();
                    }
                }, errorHandler);
            };
            readEntries();
        });
    });
}

function readVideoFileSelect(evt) {
    evt.stopPropagation();
    evt.preventDefault();
    window.requestFileSystem(window.TEMPORARY, 838860800, function(fs) {
        fs.root.getDirectory("video", {}, function(dirEntry) {
            var dirReader = dirEntry.createReader(), entries = [], readEntries = function() {
                dirReader.readEntries(function(results) {
                    if (!results.length) listVideoResults(entries.sort()); else {
                        entries = entries.concat(toArray(results));
                        readEntries();
                    }
                }, errorHandler);
            };
            readEntries();
        });
    });
}

function handleAudioFileSelect(evt) {
    evt.stopPropagation();
    evt.preventDefault();
    var files = evt.dataTransfer.files;
    window.requestFileSystem(window.TEMPORARY, 838860800, function(fs) {
        fs.root.getDirectory("audio", {
            create: !0
        }, function(dirEntry) {}, errorHandler);
        for (var i = 0, file; file = files[i]; ++i) (function(f) {
            fs.root.getFile("/audio/" + f.name, {
                create: !0,
                exclusive: !0
            }, function(fileEntry) {
                fileEntry.createWriter(function(fileWriter) {
                    fileWriter.write(f);
                }, errorHandler);
                fileEntry.file(function(file) {
                    var reader = new FileReader;
                    reader.onloadend = function(e) {
                        audio.playlist.push(fileEntry.toURL());
                        var li = document.createElement("li"), name = unescape(fileEntry.name), correctName = unescape(fileEntry.name);
                        correctName.length > 30 && (correctName = correctName.substring(0, 30));
                        li.innerHTML = [ '<a class="track" href="#" data-href="', fileEntry.toURL(), '" data-title="', correctName, '">', correctName, "</a>" ].join("");
                        document.getElementById("playlist").insertBefore(li, null);
                        var nodeList = Array.prototype.slice.call(document.getElementById("playlist").children), index = nodeList.indexOf(li);
                        li.onclick = function() {
                            playAudio(index);
                            $("#close_drop").trigger("click");
                        };
                    };
                    reader.readAsDataURL(file);
                }, errorHandler);
            }, errorHandler);
        })(file);
        $("header").delay(8e3).fadeOut(2e3);
    });
}

function handleVideoFileSelect(evt) {
    evt.stopPropagation();
    evt.preventDefault();
    var files = evt.dataTransfer.files;
    window.requestFileSystem(window.TEMPORARY, 838860800, function(fs) {
        fs.root.getDirectory("video", {
            create: !0
        }, function(dirEntry) {}, errorHandler);
        for (var i = 0, file; file = files[i]; ++i) (function(f) {
            fs.root.getFile("/video/" + f.name, {
                create: !0,
                exclusive: !0
            }, function(fileEntry) {
                fileEntry.createWriter(function(fileWriter) {
                    fileWriter.write(f);
                }, errorHandler);
                fileEntry.file(function(file) {
                    var reader = new FileReader;
                    reader.onloadend = function(e) {
                        video.playlist.push(fileEntry.toURL());
                        var li = document.createElement("li"), name = unescape(fileEntry.name), correctName = unescape(fileEntry.name);
                        correctName.length > 30 && (correctName = correctName.substring(0, 30));
                        li.innerHTML = [ '<a class="track" href="#" data-href="', fileEntry.toURL(), '" data-title="', correctName, '">', correctName, "</a>" ].join("");
                        document.getElementById("videoplaylist").insertBefore(li, null);
                        var nodeList = Array.prototype.slice.call(document.getElementById("videoplaylist").children), index = nodeList.indexOf(li);
                        li.onclick = function() {
                            playVideo(index);
                            console.log(index);
                            $("#close_drop").trigger("click");
                        };
                    };
                    reader.readAsDataURL(file);
                }, errorHandler);
            }, errorHandler);
        })(file);
        $("header").delay(8e3).fadeOut(2e3);
    });
}

function handleDragOver(evt) {
    evt.stopPropagation();
    evt.preventDefault();
    evt.dataTransfer.dropEffect = "copy";
}

function init() {
    var light = new THREE.PointLight(16777215);
    light.position.set(1e3, 1e3, 1e3).normalize();
    light.shadowCameraVisible = !0;
    light.shadowDarkness = .25;
    light.intensity = 12;
    light.castShadow = !0;
    scene.add(light);
    var directionalLightFill = new THREE.DirectionalLight(16777215);
    directionalLightFill.position.set(-1e3, 1e3, 2e3).normalize();
    directionalLightFill.shadowCameraVisible = !0;
    directionalLightFill.shadowDarkness = .25;
    directionalLightFill.intensity = 6;
    directionalLightFill.castShadow = !0;
    scene.add(directionalLightFill);
    mesh.position.z = scene.position.z;
    scene.add(mesh);
    var pointTo = 0;
    if (Modernizr.getusermedia) {
        $("header h2").text('Click "allow" to start webcam.');
        setTimeout(function() {
            $("header h2").text("Drag and Drop up to 1GB of MP3 and h.264 MP4 Video to the Playlists.");
            setTimeout(function() {
                $("header h2").text("Control the distortion and create something new.");
                $("header h2").next("a").text("Watch the video to learn more").attr("href", "http://kineticvideo.co/info/synth-early-alpha-available-now/");
                $(".close-button").trigger("click");
                setTimeout(function() {
                    $("header h2").text("Audio Waveform and Mouse Events control the Synthesizer");
                    $("header p,header h2,header h1,header a").delay(8e3).fadeOut(2e3);
                }, 5e3);
            }, 5e3);
        }, 4e3);
        navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;
        navigator.getUserMedia({
            video: !0,
            audio: !1
        }, function(stream) {
            if (navigator.mozGetUserMedia) videoInput.mozSrcObject = stream; else {
                var vendorURL = window.URL || window.webkitURL;
                webcamEnabled = !0;
                videoObject = vendorURL.createObjectURL(stream);
                videoInput.src = videoObject;
            }
        }, function(error) {
            prompt.innerHTML = "Unable to capture WebCam. Please reload the page or try with Google Chrome.";
        });
    } else $("header h2").text("Synth requires WebRTC & HTML5 Filesystem. Try it out with Google Chrome.");
    $(".property-name").mousedown(function() {
        if ($(this).not(".active")) {
            $(this).addClass("active");
            if ($(this).text() === "Bass") {
                pointer[0] = ruttEtraParams.bass;
                pointTo = 0;
                console.log(pointer[0]);
                return;
            }
            if ($(this).text() === "Mid") {
                pointer[1] = ruttEtraParams.mid;
                pointTo = 1;
                console.log(pointer[1]);
                return;
            }
            if ($(this).text() === "Treble") {
                pointer[2] = ruttEtraParams.treble;
                pointTo = 2;
                console.log(pointer[2]);
                return;
            }
            if ($(this).text() === "Mouse X") {
                pointer[3] = mouseX;
                pointTo = 3;
                console.log(pointer[3]);
                return;
            }
            if ($(this).text() === "Mouse Y") {
                pointer[4] = mouseY;
                pointTo = 4;
                console.log(pointer[4]);
                return;
            }
            $(this).text() === "Zoom" && (setting[pointTo] = "ruttEtraParams.cameraz = pointer[i] * 4");
            $(this).text() === "Camera X" && (setting[pointTo] = "ruttEtraParams.camerax = pointer[i] * 2");
            $(this).text() === "Camera Y" && (setting[pointTo] = "ruttEtraParams.cameray = pointer[i] * 10");
            $(this).text() === "Displace" && (setting[pointTo] = "ruttEtraParams.displace = pointer[i] * 100");
            $(this).text() === "Amplify" && (setting[pointTo] = "ruttEtraParams.multiplier = pointer[i] * 100");
            $(this).text() === "Distort X" && (setting[pointTo] = "ruttEtraParams.originX = pointer[i] * 100");
            $(this).text() === "Distort Y" && (setting[pointTo] = "ruttEtraParams.originY = pointer[i] * 100");
            $(this).text() === "Distort Z" && (setting[pointTo] = "ruttEtraParams.originZ = pointer[i] * 100");
            $(this).text() === "Opacity" && (setting[pointTo] = "ruttEtraParams.opacity = pointer[i]");
            if ($(this).text() === "Scale" || $(this).text() === "X Dimension" || $(this).text() === "Y Dimension" || $(this).text() === "Z Dimension" || $(this).text() === "X Segments" || $(this).text() === "Y Segments" || $(this).text() === "Z Segments") return;
            $(this).parent("div").children(".c").children(".slider").prepend('<div class="cancel" data-pointer="' + pointTo + '"></div>');
            $(this).parent("div").children(".c").children(".slider").children(".cancel").on("click", function() {
                setting[$(this).data("pointer")] = "";
                $(this).parent("li").children("div:first-child").children(".property-name").removeClass("active");
                $(this).remove();
            });
        }
    });
    if (Modernizr.filesystem) {
        $('<div id="close_drop"><p>Close Playlist</p></div>').insertAfter("audio");
        $("#close_drop").on("click", function() {
            $(this).toggleClass("active");
            $("header").fadeOut(8e3);
            if ($(this).is(".active")) {
                $("#drop_zone").hide();
                $("#video_drop").hide();
                $("audio").css("top", "20px");
                $("audio").hide();
                $(this).css("top", "0px");
                $(this).children("p").text("Open Playlist");
            } else if ($(this).not(".active")) {
                $("#drop_zone").show();
                $("#video_drop").show();
                $("audio").show();
                $("audio").css("top", "298px");
                $(this).css("top", "627px");
                $(this).children("p").text("Close Playlist");
            }
        });
    } else $("#close_drop,#video_drop,#drop_zone,audio").hide();
    document.addEventListener("mousemove", onDocumentMouseMove, !1);
    window.addEventListener("resize", onWindowResize, !1);
    keypress.combo("1", function() {
        playVideo(0);
    });
    keypress.combo("2", function() {
        playVideo(1);
    });
    keypress.combo("3", function() {
        playVideo(2);
    });
    keypress.combo("4", function() {
        playVideo(3);
    });
    keypress.combo("5", function() {
        playVideo(4);
    });
    keypress.combo("6", function() {
        playVideo(5);
    });
    keypress.combo("7", function() {
        playVideo(6);
    });
    keypress.combo("8", function() {
        playVideo(7);
    });
    keypress.combo("9", function() {
        playVideo(8);
    });
    keypress.combo("0", function() {
        onToggleWebcam();
    });
    keypress.combo("l", function() {
        videoInput.loop == 0 ? videoInput.loop = !0 : videoInput.loop = !1;
    });
    $(".close-button").on("click", function() {});
    initComplete = !0;
    animate();
}

function audioChange() {
    ruttEtraParams.bass = this.getFrequency(140) * 100;
    ruttEtraParams.mid = this.getFrequency(210) * 100;
    ruttEtraParams.treble = this.getFrequency(460) * 100;
}

function onParamsChange() {
    mesh.scale.x = mesh.scale.y = ruttEtraParams.scale;
    ruttEtraParams.mousex = mouseX;
    ruttEtraParams.mousey = mouseY;
    camera.position.x = ruttEtraParams.camerax;
    camera.position.y = ruttEtraParams.cameray;
    camera.position.z = ruttEtraParams.cameraz;
    videoMaterial.uniforms.displace.value = ruttEtraParams.displace;
    videoMaterial.uniforms.multiplier.value = ruttEtraParams.multiplier;
    videoMaterial.uniforms.opacity.value = ruttEtraParams.opacity;
    videoMaterial.uniforms.originX.value = ruttEtraParams.originX;
    videoMaterial.uniforms.originY.value = ruttEtraParams.originY;
    videoMaterial.uniforms.originZ.value = ruttEtraParams.originZ;
    effectHue.uniforms.hue.value = ruttEtraParams.hue;
    effectHue.uniforms.saturation.value = ruttEtraParams.saturation;
    $("#canvas").css("background-color", ruttEtraParams.background);
    hex = ruttEtraParams.background;
    hex = parseInt(hex.replace("#", "0x"));
    renderer.setClearColor(hex, 1);
    pointer[0] = ruttEtraParams.bass;
    pointer[1] = ruttEtraParams.mid;
    pointer[2] = ruttEtraParams.treble;
    pointer[3] = ruttEtraParams.mousex;
    pointer[4] = ruttEtraParams.mousey;
    for (var i = 0; i <= 4; i++) eval(setting[i]);
    for (var i in gui.__controllers) gui.__controllers[i].updateDisplay();
}

function meshChange(geo) {
    newMesh(ruttEtraParams.shape, ruttEtraParams.scale);
}

function newMesh(geo, scale) {
    scene.remove(mesh);
    if (geo === "plane") geometry = new THREE.PlaneGeometry(videoInput.videoWidth, videoInput.videoHeight, videoInput.videoWidth, videoInput.videoHeight); else if (geo === "sphere") geometry = new THREE.SphereGeometry(videoInput.videoHeight / 2, videoInput.videoHeight / 2, videoInput.videoHeight / 2); else if (geo === "cube") geometry = new THREE.CubeGeometry(videoInput.videoHeight / 3, videoInput.videoHeight / 3, videoInput.videoHeight / 3, videoInput.videoHeight / 3, videoInput.videoHeight / 3, videoInput.videoHeight / 3); else if (geo === "cylinder") {
        geometry = new THREE.CylinderGeometry(scale * 2, scale * 2, videoInput.videoHeight / 2, videoInput.videoWidth / 2, videoInput.videoHeight / 2, !0);
        camera.position.z = ruttEtraParams.cameraz = 40;
    } else geo === "torus" && (geometry = new THREE.TorusGeometry(scale * 2, videoInput.videoHeight / 2, videoInput.videoHeight / 2, videoInput.videoHeight / 2));
    drawNewMesh(geometry);
}

function drawNewMesh(geometry) {
    geometry.overdraw = !1;
    geometry.dynamic = !0;
    geometry.verticesNeedUpdate = !0;
    mesh = new THREE.Mesh(geometry, videoMaterial);
    mesh.position.x = 0;
    mesh.position.y = 0;
    mesh.position.z = scene.position.z;
    mesh.visible = !0;
    mesh.scale.x = mesh.scale.y = ruttEtraParams.scale;
    scene.add(mesh);
}

function onToggleWireframe() {
    videoMaterial.wireframe === !1 ? videoMaterial.wireframe = !0 : videoMaterial.wireframe = !1;
}

function onToggleWebcam() {
    ruttEtraParams.webcam === !0 ? videoInput.src = videoObject : videoInput.src = video.nowPlaying;
}

function onWindowResize() {
    windowHalfX = window.innerWidth / 2;
    windowHalfY = window.innerHeight / 2;
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
    composer.reset();
}

function onDocumentMouseMove(event) {
    mouseX = event.clientX - windowHalfX;
    mouseY = (event.clientY - windowHalfY) * .3;
}

function animate() {
    requestAnimationFrame(animate);
    render();
}

function render() {
    if (videoInput.readyState === videoInput.HAVE_ENOUGH_DATA) {
        texture && (texture.needsUpdate = !0);
        videoMaterial && (videoMaterial.needsUpdate = !0);
    }
    camera.lookAt(scene.position);
    onParamsChange();
    composer.render();
}

Detector.webgl || Detector.addGetWebGLMessage();

var container, camera, scene, renderer, video, texture, material, mesh, composer, renderModel, effectBloom, effectHue, effectCopy, mouseX = 0, mouseY = 0, windowHalfX = window.innerWidth / 2, windowHalfY = window.innerHeight / 2, videoPlayer = document.getElementById("videoplayer"), videoInput = document.getElementById("video");

videoInput.load();

videoInput.loop = !0;

var canvasInput = document.getElementById("compare"), videoObject, audio = [];

audio.playlist = [];

var audioplayer = document.getElementById("audio"), audioisplaying = !1, video = [];

video.playlist = [];

var videoisplaying = !1, dancer = new Dancer, dropZone = document.getElementById("drop_zone"), readFiles = document.getElementById("read_files"), dropZoneVideo = document.getElementById("video_drop"), readFilesVideo = document.getElementById("read_video"), initComplete = !1, webcamEnabled = !1, hex;

camera = new THREE.PerspectiveCamera(40, window.innerWidth / window.innerHeight, 1, 2e4);

camera.position.z = 3600;

window.URL = window.URL || window.webkitURL;

var gui, ruttEtraParams = {
    bass: 0,
    mid: 0,
    treble: 0,
    mousex: mouseX,
    mousey: mouseY,
    shape: null,
    wireframe: !0,
    camerax: 0,
    cameray: 0,
    cameraz: -30,
    scale: 1,
    multiplier: 12,
    displace: 6,
    opacity: .8,
    originX: 0,
    originY: 0,
    originZ: -2e3,
    hue: 0,
    saturation: .1,
    background: "#000",
    webcam: !0
}, pointer = [];

pointer.push(ruttEtraParams.bass);

pointer.push(ruttEtraParams.mid);

pointer.push(ruttEtraParams.treble);

pointer.push(ruttEtraParams.mousex);

pointer.push(ruttEtraParams.mousey);

var setting = [];

setting.push("");

setting.push("");

setting.push("");

setting.push("");

setting.push("");

container = document.getElementById("canvas");

document.body.appendChild(container);

scene = new THREE.Scene;

texture = new THREE.Texture(videoInput);

texture.minFilter = THREE.LinearFilter;

texture.magFilter = THREE.LinearFilter;

texture.format = THREE.RGBFormat;

texture.generateMipmaps = !0;

videoMaterial = new THREE.ShaderMaterial({
    uniforms: {
        tDiffuse: {
            type: "t",
            value: texture
        },
        multiplier: {
            type: "f",
            value: 66.6
        },
        displace: {
            type: "f",
            value: 33.3
        },
        opacity: {
            type: "f",
            value: 1
        },
        originX: {
            type: "f",
            value: 0
        },
        originY: {
            type: "f",
            value: 0
        },
        originZ: {
            type: "f",
            value: -2e3
        }
    },
    vertexShader: RuttEtraShader.vertexShader,
    fragmentShader: RuttEtraShader.fragmentShader,
    depthWrite: !0,
    depthTest: !0,
    wireframe: !1,
    transparent: !0,
    overdraw: !1
});

videoMaterial.renderToScreen = !0;

videoMaterial.wireframe = !0;

geometry = new THREE.PlaneGeometry(480, 270, 480, 270);

geometry.overdraw = !1;

geometry.dynamic = !0;

geometry.verticesNeedUpdate = !0;

mesh = new THREE.Mesh(geometry, videoMaterial);

mesh.position.x = 0;

mesh.position.y = 0;

mesh.visible = !0;

mesh.scale.x = mesh.scale.y = 1;

renderer = new THREE.WebGLRenderer({
    antialias: !0
});

renderer.setSize(window.innerWidth, window.innerHeight);

renderer.autoClear = !1;

container.appendChild(renderer.domElement);

composer = new THREE.EffectComposer(renderer);

renderModel = new THREE.RenderPass(scene, camera);

composer.addPass(renderModel);

effectBloom = new THREE.BloomPass(2, 20, 4, 256);

composer.addPass(effectBloom);

effectHue = new THREE.ShaderPass(THREE.HueSaturationShader);

effectHue.renderToScreen = !0;

effectHue.uniforms.hue.value = 0;

effectHue.uniforms.saturation.value = 0;

composer.addPass(effectHue);

gui = new dat.GUI({
    autoPlace: !1
});

var guiContainer = document.getElementById("gui_container");

guiContainer.appendChild(gui.domElement);

gui.remember(ruttEtraParams);

var f1 = gui.addFolder("Audio");

f1.add(ruttEtraParams, "bass", 0, 1).step(.01).listen().name("Bass").onChange(audioChange);

f1.add(ruttEtraParams, "mid", 0, 1).step(.01).listen().name("Mid").onChange(audioChange);

f1.add(ruttEtraParams, "treble", 0, 1).step(.01).listen().name("Treble").onChange(audioChange);

f1.open();

var f2 = gui.addFolder("Mouse");

f2.add(ruttEtraParams, "mousex", -960, 960).step(1).listen().name("Mouse X").onChange(onParamsChange);

f2.add(ruttEtraParams, "mousey", -540, 540).step(1).listen().name("Mouse Y").onChange(onParamsChange);

f2.open();

var f3 = gui.addFolder("Camera");

f3.add(ruttEtraParams, "cameraz", -3600, 3600).step(1).listen().name("Zoom").onChange(onParamsChange);

f3.add(ruttEtraParams, "camerax", -3600, 3600).step(1).listen().name("Camera X").onChange(onParamsChange);

f3.add(ruttEtraParams, "cameray", -3600, 3600).step(1).listen().name("Camera Y").onChange(onParamsChange);

f3.open();

var f4 = gui.addFolder("Synthesizer");

f4.add(ruttEtraParams, "displace", -100, 100).step(.1).listen().name("Displace").onChange(onParamsChange);

f4.add(ruttEtraParams, "multiplier", -100, 100).step(.1).name("Amplify").listen().onChange(onParamsChange);

f4.add(ruttEtraParams, "originX", -2e3, 2e3).step(100).listen().name("Distort X").onChange(onParamsChange);

f4.add(ruttEtraParams, "originY", -2e3, 2e3).step(100).listen().name("Distort Y").onChange(onParamsChange);

f4.add(ruttEtraParams, "originZ", -2e3, 2e3).step(100).listen().name("Distort Z").onChange(onParamsChange);

f4.add(ruttEtraParams, "opacity", 0, 1).step(.01).listen().name("Opacity").onChange(onParamsChange);

f4.add(ruttEtraParams, "hue", -1, 1).step(.01).name("Hue").onChange(onParamsChange);

f4.add(ruttEtraParams, "saturation", -1, .87).step(.01).name("Saturation").onChange(onParamsChange);

f4.addColor(ruttEtraParams, "background").name("Background Color").onChange(onParamsChange);

f4.open();

var f5 = gui.addFolder("Geometry");

f5.add(ruttEtraParams, "shape", [ "plane", "sphere", "cube", "cylinder", "torus" ]).listen().name("Shape").onChange(meshChange);

f5.add(ruttEtraParams, "scale", .1, 20).step(1).listen().name("Scale").onChange(onParamsChange);

f5.add(ruttEtraParams, "wireframe").onChange(onToggleWireframe);

f5.add(ruttEtraParams, "webcam").onChange(onToggleWebcam);

f5.open();

gui.close();

onParamsChange();

checkLoad();

window.File && window.FileReader && window.FileList && window.Blob && (window.requestFileSystem = window.requestFileSystem || window.webkitRequestFileSystem);

if (Modernizr.filesystem) {
    dropZone.addEventListener("dragover", handleDragOver, !1);
    dropZone.addEventListener("drop", handleAudioFileSelect, !1);
    readFiles.addEventListener("mousedown", readAudioFileSelect, !1);
    dropZoneVideo.addEventListener("dragover", handleDragOver, !1);
    dropZoneVideo.addEventListener("drop", handleVideoFileSelect, !1);
    readFilesVideo.addEventListener("mousedown", readVideoFileSelect, !1);
};